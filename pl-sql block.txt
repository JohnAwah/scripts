
backup the table: create table DLEX_B6RESV.RESVCUSTOMERPAYMENT_bkp as select * from DLEX_B6RESV.RESVCUSTOMERPAYMENT where RESVEVENTID NOT IN (select ID from DLEX_B6RESV.RESVEVENT);



DECLARE 
cursor cur is 
select /*+ parallel 4 */ a.RESVEVENTID  from DLEX_B6RESV.RESVCUSTOMERPAYMENT a, DLEX_B6RESV.RESVEVENT b  where a.RESVEVENTID = b.id(+) and b.id is null;
TYPE CII_TYPE IS TABLE OF NUMBER; 
CII_TYPE_TBL CII_TYPE; 
BEGIN 
OPEN CUR; 
LOOP 
FETCH CUR BULK COLLECT INTO CII_TYPE_TBL LIMIT 20000; 
FORALL i IN 1..CII_TYPE_TBL.COUNT 
DELETE FROM DLEX_B6RESV.RESVCUSTOMERPAYMENT WHERE RESVEVENTID=CII_TYPE_TBL(i); 
COMMIT; 
EXIT WHEN CUR%NOTFOUND; 
END LOOP; 
CLOSE CUR; 
END; 
/


DECLARE 
cursor cur is 
select /*+ parallel 4 */ a.RESVEVENTID  from DLEX_B6RESV.RESVCUSTOMERPAYMENT a, DLEX_B6RESV.RESVEVENT b  where a.RESVEVENTID = b.id(+) and b.id is null;
TYPE CII_TYPE IS TABLE OF NUMBER; 
CII_TYPE_TBL CII_TYPE; 
BEGIN 
OPEN CUR; 
LOOP 
FETCH CUR BULK COLLECT INTO CII_TYPE_TBL LIMIT 20000; 
FORALL i IN 1..CII_TYPE_TBL.COUNT 
SELECT * FROM DLEX_B6RESV.RESVCUSTOMERPAYMENT WHERE RESVEVENTID=CII_TYPE_TBL(i); 
COMMIT; 
EXIT WHEN CUR%NOTFOUND; 
END LOOP; 
CLOSE CUR; 
END; 
/